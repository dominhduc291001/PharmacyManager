<div class="container">
    <nz-spin nzTip="로딩..." [nzSpinning]="isSpin">
        <div class="flex flex-col flex-nowrap  w-full">
            <div class="flex mt-2 flex-col w-full p-2 border border-solid border-blue-300">
                <div class="flex flex-col">
                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>형식 구분</mat-label>
                        <mat-select [(ngModel)]="dataPage.fomCode" (selectionChange)="fomCodeChange($event)">
                            <mat-option [value]=""> =선택= </mat-option>
                            <mat-option *ngFor="let item of fomCodeList" [value]="item.value">{{item.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <div class="flex flex-row w-full">
                        <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                            <mat-label><span class="text-red-400">* </span>계기구분</mat-label>
                            <mat-select (selectionChange)="estbSeCodeChange($event)" [(ngModel)]="dataPage.estbSeCode">
                                <mat-option [value]=""> =선택= </mat-option>
                                <mat-option *ngFor="let item of estbSeCodeList" [value]="item.value">{{item.name}}</mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field *ngIf="dataPage.estbSeCode === 'AA211002' && dataPage.fomCode !== 'AA210005' && isChgEstbSeCode === true" class="w-1/4 pl-1 sm:pl-2"  appearance="outline">
                            <mat-select [(ngModel)]="dataPage.chgEstbSeCode">
                                <mat-option [value]=""> =선택= </mat-option>
                                <mat-option *ngFor="let item of chgEstbSeCodeList" [value]="item.value">{{item.name}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>상및 선식</mat-label>
                        <mat-select [(ngModel)]="dataPage.upptNdLnFrmlaCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <ng-container *ngIf="dataPage.fomCode !== 'AA210005'; else elseupp">
                                <mat-option *ngFor="let item of upptNdLnFrmlaCodeList" [value]="item.value">{{item.name}}</mat-option>
                            </ng-container>
                            <ng-template #elseupp>
                                <mat-option *ngFor="let item of upptNdLnFrmlaCodeList2" [value]="item.value">{{item.name}}</mat-option>
                            </ng-template>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field *ngIf="dataPage.fomCode !== 'AA210005'" class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>기준전압</mat-label>
                        <mat-select [(ngModel)]="dataPage.stdrVltgeCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <ng-container *ngIf="dataPage.upptNdLnFrmlaCode === 'AA212004'; else elsestdr">
                                <mat-option *ngFor="let item of stdrVltgeCodeList" [value]="item.value">{{item.name}}</mat-option>
                            </ng-container>
                            <ng-template #elsestdr>
                                <mat-option *ngFor="let item of stdrVltgeCodeList2" [value]="item.value">{{item.name}}</mat-option>
                            </ng-template>
                        </mat-select>
                        <span matSuffix>V</span>
                    </mat-form-field>

                    <mat-form-field *ngIf="dataPage.fomCode === 'AA210005'" class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>기준전압</mat-label>
                        <input [(ngModel)]="stdrVltgeCodeVal" class="text-black" matInput>
                        <span matSuffix>V</span>
                    </mat-form-field>

                    <ng-container *ngIf="dataPage.fomCode === 'AA210005' && dataPage.estbSeCode === 'AA211002'; else elseErcrt">
                        <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                            <mat-label><span class="text-red-400">* </span>기준전류</mat-label>
                            <input type="number" [(ngModel)]="stdrErcrtCodeVal" class="text-black" matInput>
                            <span matSuffix>A</span>
                        </mat-form-field>
                    </ng-container>
                    <ng-template #elseErcrt>
                        <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                            <mat-label><span class="text-red-400">* </span>기준전류</mat-label>
                            <mat-select [(ngModel)]="dataPage.stdrErcrtCode">
                                <mat-option [value]=""> =선택= </mat-option>
                                <ng-container *ngIf="dataPage.estbSeCode !== 'AA211002'">
                                    <mat-option *ngFor="let item of stdrErcrtCodeList1" [value]="item.value">{{item.name}}</mat-option>
                                </ng-container>
                                <ng-container *ngIf="dataPage.fomCode !== 'AA210005' && dataPage.estbSeCode !== 'AA211001'; else elseTemplate">
                                    <mat-option *ngFor="let item of stdrErcrtCodeList2" [value]="item.value">{{item.name}}</mat-option>
                                </ng-container>
                                <ng-template #elseTemplate>
                                    <mat-option *ngFor="let item of stdrErcrtCodeList3" [value]="item.value">{{item.name}}</mat-option>
                                </ng-template>
                            </mat-select>
                            <span matSuffix>A</span>
                        </mat-form-field>
                    </ng-template>

                    <div class="flex flex-row w-full">
                        <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                            <mat-label><span class="text-red-400">* </span>최대허용 전류</mat-label>
                            <input type="number" [(ngModel)]="dataPage.mxmmPermErcrtVal" class="text-black" [disabled]="isMxmmPermErcrtVal" matInput>
                            <span matSuffix>A</span>
                        </mat-form-field>

                        <mat-form-field *ngIf="dataPage.estbSeCode === 'AA211002'" class="w-1/4 pl-1 sm:pl-2"  appearance="outline">
                            <mat-select [(ngModel)]="selMxmmPermErcrtTimes" (selectionChange)="selMxmmChange($event)">
                                <mat-option [value]=""> =선택= </mat-option>
                                <mat-option *ngFor="let item of selMxmmPermErcrtTimesList" [value]="item.value">{{item.name}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>승인서전류표기값</mat-label>
                        <input [(ngModel)]="dataPage.printErcrtVal" (click)="printErcrtValChange($event)"  class="text-black" matInput>
                    </mat-form-field>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>유효등급</mat-label>
                        <mat-select [(ngModel)]="dataPage.validGradCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <mat-option *ngFor="let item of validGradCodeList" [value]="item.value">{{item.name}}</mat-option>
                        </mat-select>
                        <span matSuffix>급</span>
                    </mat-form-field>

                    <mat-form-field *ngIf="dataPage.fomCode !== 'AA210005'" class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>무효등급</mat-label>
                        <mat-select [(ngModel)]="dataPage.unavblGradCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <mat-option *ngFor="let item of unavblGradCodeList" [value]="item.value">{{item.name}}</mat-option>
                        </mat-select>
                        <span matSuffix>급</span>
                    </mat-form-field>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>계량방향</mat-label>
                        <mat-select [(ngModel)]="dataPage.mesurDrcCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <mat-option *ngFor="let item of mesurDrcCodeList" [value]="item.value">{{item.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>형식명</mat-label>
                        <input [(ngModel)]="dataPage.fomNm" class="text-black" matInput>
                    </mat-form-field>

                    <mat-form-field class="w-full sm:w-3/4" appearance="outline">
                        <mat-label><span class="text-red-400">* </span>접속구조</mat-label>
                        <mat-select [(ngModel)]="dataPage.conectStrctCode">
                            <mat-option [value]=""> =선택= </mat-option>
                            <mat-option *ngFor="let item of conectStrctCodeList" [value]="item.value">{{item.name}}</mat-option>
                        </mat-select>
                    </mat-form-field>

                </div>
            </div>

            <div class="flex flex-col flex-nowrap w-full">
                <div class="grid mt-6 w-full">
                    <div class="place-self-end">
                        <button (click)="saveDetail()" class="h-10 w-20 -mt-2 ml-2 mb-1" nz-button nzType="primary" [nzSize]="'small'">저장</button>
                        <button (click)="close()" class="h-10 w-20 -mt-2 ml-2 mb-1" nz-button nzType="primary" [nzSize]="'small'">닫기</button>
                    </div>
                </div>
            </div>
        </div>
    </nz-spin>
</div>
